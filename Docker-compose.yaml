version: "3"
services: 
  
  fastapi_app:
    image: sharabhs/fastapi_celery_frontend
    ports:
      - "8080:8080"
    depends_on:
      - rabbit
      - celery_worker
      - redis_container

  rabbit:
    hostname: rabbit
    image: "rabbitmq:3-management"
    environment:
      - RABBITMQ_DEFAULT_USER=myadmin
      -  RABBITMQ_DEFAULT_PASS=password
    ports:
      - "15672:15672"
      - "5672:5672"

  redis_container:
    hostname: redis-service
    image: redis:latest
    ports:
     - 6379:6379

  celery_worker:
    image: sharabhs/fastapi_celery_worker
    depends_on: 
      - redis_container
      - rabbit